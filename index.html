<!DOCTYPE html>
<html>
<head>
  <title>Google Sheet Data Example</title>
</head>
<body>
  <h2>Products</h2>
  <div id="products"></div>

  <script>
    const sheetID = "YOUR_SHEET_ID";
    const url = `https://docs.google.com/spreadsheets/d/$2PACX-1vRIePwiEKMLEjXx8dbFUGjIrK9Ow0A3MDHGWlVMdB2GgD3FLkKwJPGidR0DKEVJXHy5gAVJDmQZ4xP9/gviz/tq?tqx=out:json`;

    fetch(url)
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substring(47).slice(0, -2)); // clean up Google wrapper
        const rows = json.table.rows;

        // Optional: get column headers
        const headers = json.table.cols.map(col => col.label);

        // Convert rows to array of objects
        const data = rows.map(row => {
          return row.c.reduce((obj, cell, i) => {
            obj[headers[i]] = cell ? cell.v : "";
            return obj;
          }, {});
        });

        // Now you can use `data` however you want!
        const container = document.getElementById("products");
        data.forEach(item => {
          container.innerHTML += `
            <div>
              <strong>${item.Title}</strong><br>
              Price: $${item.Price}<br>
              Description: ${item["In Stock"]}
              <hr>
            </div>
          `;
        });
      });
  </script>
</body>
</html>
